# Cosmetic Raw Material Checker (화장품 원료 검증기)

화장품 원료(RM)와 전성분(INCI) 데이터를 담은 두 개의 테이블을 비교·검증하는 데스크톱 애플리케이션입니다.
복잡한 원료 배합비와 성분비를 시각적으로 비교하고, 검토 결과를 엑셀로 저장할 수 있습니다.

## ✨ 주요 기능

### 1. 엑셀 데이터 로드 및 시각화

- 지정된 템플릿 양식의 엑셀 파일을 불러와 **Table 1**과 **Table 2**에 표시합니다.
- **자동 병합 (Auto Merge)**: 동일한 원료(RM)가 연속될 경우 셀을 자동으로 병합하여 가독성을 높입니다.
- **자동 정렬**: 원료명과 성분명을 기준으로 데이터를 항상 정렬합니다.

### 2. 비교 로직 (Diff & Validation)

두 테이블을 비교하여 차이점을 실시간으로 하이라이트합니다.

- **빨간색 글씨**: 원료 함량(`% RM/FP`)이나 성분 함량(`% INCI/RM`)이 서로 다른 경우.
- **빨간색 배경**: 상대 테이블에 해당 원료(RM)나 성분(INCI)이 아예 없는 경우 (누락).
- **입력 유효성 검사**: 원료명 변경 시, 이미 존재하는 다른 원료와 함량이 다르면 경고창을 띄워 실수를 방지합니다.

### 3. 편집 편의 기능

- **동기화 스크롤**: `Shift + 스크롤`로 양쪽 테이블을 동시에 움직여 비교하기 편합니다.
- **행 분할 (Row Split)**: 우클릭 메뉴를 통해 특정 행을 새로운 원료 그룹으로 쉽게 분리할 수 있습니다 (`(1)` 접미사 자동 추가).

### 4. 결과 엑셀 저장

검토가 완료된 데이터를 **3가지 시트**로 구성된 엑셀 파일로 저장합니다.

- **Result**: 두 테이블을 좌우로 나란히 배치하여 한눈에 비교 (하이라이트 스타일 유지).
- **Table1 / Table2**: 각 테이블의 데이터만 별도 시트로 저장.
- **포맷팅**: 숫자형 데이터 변환, 컬럼 너비 자동 조정, 셀 병합 등 보고서용 포맷 적용.

---

## 🛠️ 기술 스택 (Tech Stack)

- **Language**: Python 3.10+
- **GUI Framework**: PyQt5
- **Data Processing**: openpyxl (Excel I/O), Dataclasses
- **Architecture**: MVC Pattern (Model-View-Controller)
  - `models.py`: 데이터 구조 (`IngredientRow`, `DiffItem`)
  - `excel.py`: 비즈니스 로직 및 엑셀 처리
  - `ui/widgets.py`: 커스텀 테이블 위젯 (`MaterialTableWidget`)
  - `main.py`: 애플리케이션 진입점 및 컨트롤러

---

## 🚀 실행 방법

### 1. 필수 라이브러리 설치

```bash
pip install PyQt5 openpyxl
```

### 2. 애플리케이션 실행

프로젝트 루트 폴더에서 아래 명령어를 실행합니다.

```bash
python -m app.main
```
